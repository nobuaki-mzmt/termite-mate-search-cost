library(viridis)
ggplot(d.foundation, aes(x=treat, y=foundation))+
geom_boxplot()
ggplot(d.foundation, aes(x=treat, y=foundation))+
geom_bar()
ggplot(d.foundation, aes(x=treat, y=foundation))+
geom_bar(mapping = aes(x = cut, y = ..count..), stat = "count")
diamonds
ggplot(d.foundation)+
geom_bar(mapping = aes(x = foundation, y = ..count..), stat = "count")
dataMeans <- tapply(d.foundation$foundation, d.foundation$treat, mean)
dataMeans
barplot(dataMeans, beside=T, ylim=c(0,1), xlab="treatment", ylab="foundation success ratio",
las=1)
ggplot(d.foundation, aes(x=treat, y=foundation))+
geom_bar(mapping = aes(x = cut, y = ..count..), stat = "count")
ggplot(d.foundation, aes(x=treat, y=foundation))
ggplot(d.foundation, aes(x=treat, y=foundation)) +
geom_point()
ggplot(d.foundation, aes(x=treat, y=foundation)) +
geom_point()+
stat_summary()
ggplot(d.foundation, aes(x=treat, y=foundation)) +
geom_point()+
stat_summary(fun = "mean")
ggplot(d.foundation, aes(x=treat, y=foundation)) +
geom_point()+
stat_summary(fun = "mean", geom = "bar")
ggplot(d.foundation, aes(x=treat, y=foundation)) +
stat_summary(fun = "mean", geom = "bar")
ggplot(d.foundation, aes(x=treat, y=foundation)) +
stat_summary(fun = "mean", geom = "bar") +
scale_y_continuous(limits=c(0,1))
ggplot(d.foundation, aes(x=treat, y=foundation)) +
stat_summary(fun = "mean", geom = "bar") +
scale_y_continuous(limits=c(0,1)) +
theme_bw()
ggplot(d.foundation, aes(x=treat, y=foundation)) +
stat_summary(fun = "mean", geom = "bar") +
scale_y_continuous(limits=c(0,1)) +
theme_simple()
ggplot(d.foundation, aes(x=treat, y=foundation)) +
stat_summary(fun = "mean", geom = "bar") +
scale_y_continuous(limits=c(0,1)) +
theme_classic()
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T)
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()
table(d.foundation[,c("treat", "foundation")])
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlabel("")+ylabel("Prop of colony foundation success")
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(label = c("40/45","28/39"))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(label = c("40/45","28/39")))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=treat, y=foundation, label = c("40/45","28/39")))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45"))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=1, y=0.5, label = "28/39"))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
r <- glmer(foundation~treat+(1|colony/ID), family="binomial", data=d.foundation)
library(lme4)
library(car)
r <- glmer(foundation~treat+(1|colony/ID), family="binomial", data=d.foundation)
Anova(r)
r <- glmer(foundation~treat+(1|colony/ID), family="binomial", data=d.foundation)
d.foundation
r <- glmer(foundation~treat+(1|colony), family="binomial", data=d.foundation)
Anova(r)
ggplot(d.foundation, aes(x=offspring, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
ggplot(d.foundation, aes(x=offspring, y=foundation, fill=treat)) +
geom_point()
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_point()
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
library(cowplot)
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
library(readr)
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
?geom_flat_violin
??geom_flat_violin
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
install.packages( c( "dplyr", "ggplot2", "plyr" ) )
install.packages(c("dplyr", "ggplot2", "plyr"))
install.packages(c("dplyr", "ggplot2", "plyr"))
#------------------------------------------------------------------------------#
{
library(data.table)
library(lme4)
library(car)
library(ggplot2)
library(viridis)
}
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
source( './geom_flat_violin.R' )
library(PupillometryR)
install.packages('PupillometryR')
library(PupillometryR)
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
ggplot(d.foundation, aes(y=treat, x=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
ggplot(d.foundation, aes(y=treat, x=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
ggplot(d.foundation, aes(y=treat, x=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(y=.25,x=0),adjust =2,trim=TRUE)
ggplot(d.foundation, aes(y=treat, x=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(y=.25,x=0),adjust =2,trim=TRUE)
ggplot(d.foundation, aes(y=treat, x=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(y=.25,x=0))
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25)
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offsprint))
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring))
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Score')+xlab('Group')+
coord_flip()+
theme_cowplot()+
guides(fill= FALSE, colour=FALSE)+
scale_colour_brewer(palette="Dark2")+
scale_fill_brewer(palette="Dark2")+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation, aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
d.foundation
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25)
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring)
)
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.factor(treat)+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_cowplot()+
guides(fill= FALSE, colour=FALSE)+
scale_colour_brewer(palette="Dark2")+
scale_fill_brewer(palette="Dark2")+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5)
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .15), size=.25) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .1), size=.25) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.25) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.25,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.25, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.2,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.1, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.2,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.2, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
coord_flip()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =1,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation, aes(x=-treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
coord_flip()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
#table(d.foundation[,c("treat", "foundation")])
d.foundation <- transform(d.foundation, treat= factor(treat, levels = c("3day", "0day")))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
coord_flip()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
coord_flip()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=1, y=0.5, label = "40/45")) +
geom_text(aes(x=2, y=0.5, label = "28/39"))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_y_continuous(limits=c(0,30))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
coord_flip()+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=2, y=0.5, label = "40/45")) +
geom_text(aes(x=1, y=0.5, label = "28/39"))
ggplot(d.foundation[d.foundation$foundation==1,], aes(x=treat, y=offspring, fill=treat)) +
geom_flat_violin(position=position_nudge(x=.15,y=0),adjust =2,trim=TRUE)+
geom_point(position = position_jitter(width = .05), size=.4) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.15, y=offspring),
outlier.shape=NA, alpha=0.3, width=.1, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
coord_flip()+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_y_continuous(limits=c(0,30))
r <- glmer(offspring~treat+(1|colony), family="poisson", data=d.foundation[d.foundation$foundation>0,])
Anova(r)
r <- glmer(foundation~treat+(1|colony), family="binomial", data=d.foundation)
Anova(r)
r <- glmer(offspring~treat+(1|colony), family="poisson", data=d.foundation[d.foundation$foundation>0,])
Anova(r)
