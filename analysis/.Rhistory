ylab('Fresh weight (mg)')+xlab('')+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_color_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_y_continuous(limits=c(0,4)) +
theme(legend.position = "none")+
theme(axis.text = element_text(size = 7),
axis.title = element_text(size = 9),
legend.position = "none")
#------------------------------------------------------------------------------#
{
library(data.table)
library(lme4)
library(car)
library(exactRankTests)
library(Rmisc)
library(ggplot2)
library(viridis)
library(PupillometryR)
}
d.weight <- data.frame(fread("data/raw/termite_weight.csv", header=T))
d.weight <- transform(d.weight, day= factor(day, levels = c("0day", "3day")))
d.weight$id <- paste(d.weight$colony, d.weight$sex, d.weight$rep, sep="_")
ggplot(d.weight, aes(x=sex, y=fresh, fill=day, col=day)) +
geom_point(position = position_jitterdodge(jitter.width = .05, dodge.width = .8), size=1) +
geom_boxplot(outlier.shape=NA, alpha=0.3, width=.8, colour="BLACK")+
ylab('Fresh weight (mg)')+xlab('')+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_color_viridis(discrete = T, alpha=0.5, direction = -1) +
scale_y_continuous(limits=c(0,4)) +
theme(legend.position = "none")+
theme(axis.text = element_text(size = 7),
axis.title = element_text(size = 9),
legend.position = "none")
ggsave("output/fresh_weight.pdf", width=3, height=4)
ggplot(d.weight, aes(x=sex, y=fresh, fill=day, col=day)) +
geom_point(position = position_jitterdodge(jitter.width = .05, dodge.width = .8), size=1) +
geom_boxplot(outlier.shape=NA, alpha=0.3, width=.8, colour="BLACK")+
ylab('Fresh weight (mg)')+xlab('')+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_color_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_y_continuous(limits=c(0,4)) +
theme(legend.position = "none")+
theme(axis.text = element_text(size = 7),
axis.title = element_text(size = 9),
legend.position = "none")
ggplot(d.weight, aes(x=sex, y=fresh, fill=day, col=day)) +
geom_point(position = position_jitterdodge(jitter.width = .05, dodge.width = .8), size=1) +
geom_boxplot(outlier.shape=NA, alpha=0.3, width=.8, colour="BLACK")+
ylab('')+xlab('')+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_color_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_y_continuous(limits=c(0,4)) +
theme(legend.position = "none")+
theme(axis.text = element_text(size = 7),
axis.title = element_text(size = 9),
legend.position = "none")+
ggtitle("Fresh weight (mg)")
ggplot(d.weight, aes(x=sex, y=fresh, fill=day, col=day)) +
geom_point(position = position_jitterdodge(jitter.width = .05, dodge.width = .8), size=1) +
geom_boxplot(outlier.shape=NA, alpha=0.3, width=.8, colour="BLACK")+
ylab('')+xlab('')+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_color_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_y_continuous(limits=c(0,4)) +
theme(legend.position = "none")+
theme(axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
plot.title = element_text(size = 10),
legend.position = "none")+
ggtitle("Fresh weight (mg)")
ggsave("output/fresh_weight.pdf", width=1.6, height=2.6)
ggplot(d.weight, aes(x=sex, y=fresh, fill=day, col=day)) +
geom_point(position = position_jitterdodge(jitter.width = .05, dodge.width = .8), size=.5) +
geom_boxplot(outlier.shape=NA, alpha=0.3, width=.8, colour="BLACK")+
ylab('')+xlab('')+
theme_classic()+
scale_fill_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_color_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_y_continuous(limits=c(0,4)) +
theme(legend.position = "none")+
theme(axis.text = element_text(size = 8),
axis.title = element_text(size = 10),
plot.title = element_text(size = 10),
legend.position = "none")+
ggtitle("Fresh weight (mg)")
load("data/df_sum.rda")
df_sum = transform(df_sum, day=factor(day))
df_sum$pause_duration <- df_sum$pause_duration/5
# traveled distances
sumrepdat <- summarySE(df_sum, measurevar = "traveled_dis",
groupvars=c("day", "sex"))
#------------------------------------------------------------------------------#
{
library(data.table)
library(lme4)
library(car)
library(exactRankTests)
library(Rmisc)
library(ggplot2)
library(viridis)
library(PupillometryR)
}
load("data/df_sum.rda")
df_sum = transform(df_sum, day=factor(day))
df_sum$pause_duration <- df_sum$pause_duration/5
# traveled distances
sumrepdat <- summarySE(df_sum, measurevar = "traveled_dis",
groupvars=c("day", "sex"))
dodge_w = .3
ggplot(df_sum, aes(x=day, y=traveled_dis, col=sex))+
geom_point(aes(x = (day), y = traveled_dis, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = traveled_dis, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = traveled_dis, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = traveled_dis,
group = sex, colour = sex,
ymin = traveled_dis-se, ymax = traveled_dis+se), width = .05)+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Traveled distance (mm)")
r = lmer(traveled_dis ~ day * sex + (1|colony/id), data=df_sum)
Anova(r)
r = lmer(traveled_dis ~ as.numeric(day) * sex + (1|colony/id), data=df_sum)
Anova(r)
r = lmer(traveled_dis ~ day * sex + (1|colony/id), data=df_sum)
Anova(r)
# pause duration
sumrepdat <- summarySE(df_sum, measurevar = "pause_duration",
groupvars=c("day", "sex"))
dodge_w = .3
ggplot(df_sum, aes(x=day, y=pause_duration, col=sex))+
geom_point(aes(x = (day), y = pause_duration, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = pause_duration, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = pause_duration, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = pause_duration,
group = sex, colour = sex,
ymin = pause_duration-se, ymax = pause_duration+se), width = .05)+
scale_y_continuous(limits = c(0,1501))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggsave("output/pause_duration.pdf", width = 4, height=3)
r = lmer(pause_duration ~ day * sex + (1|colony/id), data=df_sum)
Anova(r)
# mean moving speed
ggplot(df_sum, aes(x = (day), y = mean_moving_speed, fill = sex)) +
geom_flat_violin(aes(fill = sex),position = position_nudge(x = .1, y = 0), adjust = 1.5, trim = TRUE, alpha = .5, colour = NA)+
geom_point(aes(x = as.numeric(day)-.15, y = mean_moving_speed, colour = sex),position = position_jitter(width = .05), size = 1, shape = 20)+
geom_boxplot(aes(x = day, y = mean_moving_speed, fill = sex),outlier.shape = NA, alpha = .5, width = .1, colour = "black")+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
scale_y_continuous(limits = c(0, 3.5))
sumrepdat <- summarySE(df_sum, measurevar = "mean_moving_speed",
groupvars=c("day", "sex"))
sumrepdat
sumrepdat <- summarySE(df_sum, measurevar = "mean_moving_speed",
groupvars=c("day", "sex"),na.rm = T)
sumrepdat
dodge_w = .3
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0,1501))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0,1))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0,20))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 5))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 4))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 4))+
scale_colour_viridis(discrete = T, end=.10)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 4))+
scale_colour_viridis(discrete = T, end=.30)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 4))+
scale_colour_viridis(discrete = T, end=.100)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 100))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 4))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Pausing duration (second)")
mean_moving_speed
df_sum$mean_moving_speed <- df_sum$mean_moving_speed  * 5
sumrepdat <- summarySE(df_sum, measurevar = "mean_moving_speed",
groupvars=c("day", "sex"),na.rm = T)
dodge_w = .3
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 4))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Movement speed (mm / sec)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 20))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Movement speed (mm / sec)")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 20))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Movement speed (mm / sec)") +
theme(axis.text = element_text(size = 7),
axis.title = element_text(size = 9),
legend.position = "none")
ggplot(df_sum, aes(x=day, y=mean_moving_speed, col=sex))+
geom_point(aes(x = (day), y = mean_moving_speed, colour = sex),
position = position_jitterdodge(jitter.width = .05, dodge.width = dodge_w),
size = .9, shape = 20, alpha=.25)+
geom_line(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
linetype = 3)+
geom_point(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed, group = sex, colour = sex),
shape = 1) +
geom_errorbar(data = sumrepdat, position = position_dodge(width = dodge_w),
aes(x = (day), y = mean_moving_speed,
group = sex, colour = sex,
ymin = mean_moving_speed-se, ymax = mean_moving_speed+se), width = .05)+
scale_y_continuous(limits = c(0, 20))+
scale_colour_viridis(discrete = T, end=.5)+
scale_fill_viridis(discrete = T)+
theme_classic()+
xlab("Day") + ylab("Movement speed (mm / sec)") +
theme(axis.text = element_text(size = 7),
axis.title = element_text(size = 9),
legend.position = "none")
ggsave("output/mean_movement_speed.pdf", width = 2.5, height=2.5)
r = lmer(mean_moving_speed ~ day + sex + (1|colony/id), data=df_sum)
Anova(r)
r = lmer(mean_moving_speed ~ day * sex + (1|colony/id), data=df_sum)
Anova(r)
r = lmer(mean_moving_speed ~ day * sex + (1|colony), data=df_sum)
Anova(r)
df_sum
r = lmer(mean_moving_speed ~ day * sex + (1|colony/id), data=df_sum)
Anova(r)
load("data/df_all.rda")
df_MSD <- transform(df_MSD, day= factor(day))
df_MSD_extract <- df_MSD[df_MSD$tau %in% c(.2,.5,1,2,5,10,20,50,100,200,500,1000), ]
r <- lmer(log10(MSD)~log10(tau)*day*sex+(1|colony/id), data=df_MSD_extract)
Anova(r)
# turning patterns
ggplot(df_sum, aes(x = (day), y = rho, fill = sex)) +
geom_flat_violin(aes(fill = sex),position = position_nudge(x = .1, y = 0), adjust = 1.5, trim = TRUE, alpha = .5, colour = NA)+
geom_point(aes(x = as.numeric(day)-.15, y = rho, colour = sex),position = position_jitter(width = .05), size = 1, shape = 20)+
geom_boxplot(aes(x = day, y = rho, fill = sex),outlier.shape = NA, alpha = .5, width = .1, colour = "black")+
scale_colour_brewer(palette = "Dark2")+
scale_fill_brewer(palette = "Dark2")+
scale_y_continuous(limits = c(0, 1))
r = lmer(rho ~ day + sex + (1|colony/id), data=df_sum)
Anova(r)
d.foundation <- data.frame(fread("data/raw/colonyfoundation.csv", header=T))
#table(d.foundation[,c("treat", "foundation")])
d.foundation <- transform(d.foundation, treat= factor(treat, levels = c("0day", "3day")))
ggplot(d.foundation, aes(x=treat, y=foundation, fill=treat)) +
stat_summary(fun = "mean", geom = "bar") +
scale_fill_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_y_continuous(limits=c(0,1)) +
theme_classic()+
theme(legend.position = "none")+
xlab("")+ylab("Prop of colony foundation success")+
geom_text(aes(x=2, y=0.5, label = "40/45")) +
geom_text(aes(x=1, y=0.5, label = "28/39"))
ggplot(d.foundation[d.foundation$foundation==1,],
aes(x=treat, y=offspring, fill=treat, col=treat)) +
geom_point(position = position_jitter(width = .05), size=1) +
geom_boxplot(aes(x=as.numeric(as.factor(treat))+0.0, y=offspring),
outlier.shape=NA, alpha=0.3, width=.5, colour="BLACK")+
ylab('Num offsprings')+xlab('')+
theme_classic()+
theme(legend.position = "none")+
scale_fill_viridis(discrete = T, alpha=0.5, direction = 1) +
scale_color_viridis(discrete = T, alpha=0.5, direction = 1, end=1) +
scale_y_continuous(limits=c(0,30)) +
theme(axis.text = element_text(size = 7),
axis.title = element_text(size = 9),
legend.position = "none")
r <- glmer(foundation~treat+(1|colony), family="binomial", data=d.foundation)
Anova(r)
r <- glmer(offspring~treat+(1|colony), family="poisson", data=d.foundation[d.foundation$foundation>0,])
Anova(r)
sessionInfo()
